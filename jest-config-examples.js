// Example Jest configuration with dynamic Material-UI version detection
// This configuration is automatically generated by the React Jest Test Generator extension
// based on the Material-UI version detected in your package.json

module.exports = {
  testEnvironment: "jsdom",
  
  transform: {
    "^.+\\.(js|jsx|ts|tsx)$": "babel-jest"
  },
  
  transformIgnorePatterns: [
    "node_modules/(?!enzyme-adapter-react-16|@mui|@emotion|@material-ui)"
  ],
  
  moduleNameMapper: {
    // Style files
    "\\.(css|less|scss|sass)$": "identity-obj-proxy",
    
    // Asset files
    "\\.(jpg|jpeg|png|gif|svg)$": "<rootDir>/__mocks__/fileMock.js",
    
    // Cheerio mock (fixes Enzyme compatibility issues)
    "^cheerio$": "<rootDir>/__mocks__/cheerio.js",
    "^cheerio/(.*)$": "<rootDir>/__mocks__/cheerio.js",
    
    // Node.js built-in modules compatibility (fixes node:stream errors)
    "^node:(.*)$": "$1",
    
    // Dynamic Material-UI mappings based on detected version:
    
    // For Material-UI v5 (@mui/material) - detected when package.json contains "@mui/material"
    "^@mui/material/(.*)$": "<rootDir>/__mocks__/@mui/material/$1",
    "^@mui/icons-material/(.*)$": "<rootDir>/__mocks__/@mui/icons-material/$1",
    
    // For Material-UI v4 (@material-ui/core) - detected when package.json contains "@material-ui/core"
    // Note: These mappings are used instead of the @mui ones when v4 is detected
    // "^@material-ui/core/(.*)$": "<rootDir>/__mocks__/@material-ui/core/$1",
    // "^@material-ui/icons/(.*)$": "<rootDir>/__mocks__/@material-ui/icons/$1",
    
    // Common library mocks
    "^react-router-dom$": "<rootDir>/__mocks__/react-router-dom.js",
    "^axios$": "<rootDir>/__mocks__/axios.js"
  },
  
  setupFilesAfterEnv: [
    "<rootDir>/src/setupTests.js"
  ],
  
  testMatch: [
    "<rootDir>/src/**/__tests__/**/*.(js|jsx|ts|tsx)",
    "<rootDir>/src/**/*.(test|spec).(js|jsx|ts|tsx)",
    "<rootDir>/__tests__/**/*.(js|jsx|ts|tsx)"
  ],
  
  collectCoverageFrom: [
    "src/**/*.{js,jsx,ts,tsx}",
    "!src/**/*.d.ts",
    "!src/index.js",
    "!src/setupTests.js"
  ]
};

// Version Detection Logic:
// The extension automatically detects which Material-UI version you're using by checking:
// 1. Dependencies in package.json for "@mui/material" (v5)
// 2. Dependencies in package.json for "@material-ui/core" (v4)
// 3. Generates appropriate mocks and moduleNameMapper entries based on detection